#include <main.h>
#include <stdlib.h>
#include <stdio.h>
#define ADCMAX 255
int16 adc_value;

#INT_TIMER0
void  TIMER0_isr(void){

}

#INT_EXT
void  EXT_isr(void){

}
void init(){
   setup_adc_ports(AN0, VSS_VDD);
   setup_adc(ADC_CLOCK_INTERNAL | ADC_TAD_MUL_0);
   setup_timer_0(RTCC_INTERNAL|RTCC_DIV_32);      //1.0 s overflow
   enable_interrupts(INT_TIMER0);
   enable_interrupts(INT_EXT);
   enable_interrupts(GLOBAL);
}
int8 adc(){
   set_adc_channel(0);
   delay_ms(15);
   int8 value = read_adc();
   return value;
}
void main(){
   while(TRUE){
      init();
      adc_value = adc();
      
      if (0 < adc_value < (ADCMAX/3) ) output_high(PIN_B1);
      else output_low(PIN_B1);
      if ((ADCMAX/3) < adc_value < (ADCMAX/2) ) output_high(PIN_B2);
      else output_low(PIN_B2);
      if ((ADCMAX/2) < adc_value < (ADCMAX) ) output_high(PIN_B2);
      else output_low(PIN_B2);
   }
}
