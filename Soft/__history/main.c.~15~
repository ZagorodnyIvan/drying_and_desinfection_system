#include <main.h>
#include <stdlib.h>
#include <stdio.h>

int16 adc_value;

#INT_TIMER0
void  TIMER0_isr(void){

}

#INT_EXT
void  EXT_isr(void){

}
void init(){
   setup_adc_ports(AN0, VSS_VDD);
   setup_adc(ADC_CLOCK_INTERNAL | ADC_TAD_MUL_0);
   setup_timer_0(RTCC_INTERNAL|RTCC_DIV_32);      //1.0 s overflow
   enable_interrupts(INT_TIMER0);
   enable_interrupts(INT_EXT);
   enable_interrupts(GLOBAL);
}
int16 adc(){
   set_adc_channel(0);
   delay_ms(11);
   int16 value = read_adc();
   return value;
}
void main(){
   while(TRUE){
      init();
      adc_value = adc();
      if (adc_value > 10) output_high(PIN_B1);
      else output_low(PIN_B1);
   }
}
